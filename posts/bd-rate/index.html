<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Bjontegaard Delta-Rate Metric - Max Sharabayko Blog</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/blog/css/style.css><link rel=stylesheet href=/blog/css/custom.css><link rel="shortcut icon" href=/blog/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/blog/ title="Max Sharabayko Blog" rel=home><div class="logo__item logo__text"><div class=logo__title>Max Sharabayko Blog</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/blog/><i class='fa fa-heart'></i>
<span class=menu__text>blog</span></a></li><li class=menu__item><a class=menu__link href=/blog/papers/><span class=menu__text>Publications</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Bjontegaard Delta-Rate Metric</h1><p class=post__lead>Comparing video compression efficiency</p><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 110 28 1 1 0 010-28m0 3a3 3 0 100 22 3 3 0 000-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class=meta__text datetime=2022-12-29T00:00:00Z>December 29, 2022</time></div></div></header><div class="content post__content clearfix"><p>A video encoder can be configured in many ways: different GOP (Group of Pictures) structure,
different quantization parameters (QP) or target bitrate,
motion compensation range, etc. Furthermore, different encoders likely produce different compressed streams.
Depending on the encoder and the configuration the same source video is compressed differently, each having its own bitrate and distortion value.
Bjontegaard Delta-Rate (BD Rate) metric can be used to compare and choose the encoder or configuration, that provides the best compression results.</p><h3 id=rate-distortion-plot>Rate-Distortion Plot</h3><p>Assume there are two video encoders to compare in terms of compression efficiency.
Here by the term &ldquo;compression efficiency&rdquo; the following two measures are assumed:</p><ol><li>Bitrate (bits per second) of a compressed video sequence.</li><li>Video distortion introduced by lossy compression.</li></ol><p>Both encoders allow configuring their compression settings, affecting
target bitrate and distortion.
Within a single configuration the target bitrate can be varied (varying the quantization parameters)
producing different bitrate and distortion.</p><p>Let us assume we have four different compression results for each of the two encoders (A and B).
Marking the bitrate on the x-axis and PSNR distortion on the y-axis the rate-distortion plot can be drawn
as shown in the figure below.
Obviously, the higher the points are located, the more efficient the compression
is (<em><strong>less distortion and higher visual quality is provided at lower bit rates</strong></em>).</p><figure><img src=/blog/posts/bd-rate/rd-plot.png alt="Rate-Distortion Compression Efficiency Points of Two Hypothetical Video Encoders"><figcaption><p>Rate-Distortion Compression Efficiency Points of Two Hypothetical Video Encoders</p></figcaption></figure><p>In the example above we obviously see <strong>Encoder A</strong>
provides superior results to <strong>Encoder B</strong>.<br>How do we compare the efficiency in numerical form?</p><h3 id=rate-distortion-curve>Rate-Distortion Curve</h3><p>One way to compare the efficiency in numerical form is to fix one measurement and compare by another.
Let&rsquo;s say, we want to compare bit rate savings at a certain PSNR distortion level
of 38 dB, but available measure points are not exactly there.
We need to interpolate the rate-distortion curve to get an approximation
of the bit rate at the target distortion level (see figure below).</p><figure><img src=/blog/posts/bd-rate/rd-plot-interpol.png alt="Rate-Distortion Curves"><figcaption><p>Rate-Distortion Curves</p></figcaption></figure><p>With the help of interpolation we now have two RD curves instead of points.
Interpolation of an RD-curve can be done in different ways: linear, polynomial,
and spline interpolations. The most widely adopted is the piecewise cubic interpolation.</p><p>By measuring the distance between the two curves at the certain distortion level
the bitrate &ldquo;savings&rdquo; of the one encoder compared to the other one at this distortion level can be compared numerically.</p><p>But how do we compare compression efficiency on the whole distortion interval
available?</p><h3 id=bd-rate-metric>BD Rate Metric</h3><p>Bjontegaard Delta-Rate (BD Rate) metric, proposed in 2001 by Gisle Bjontegaard, is a method for calculating
the average difference between two rate-distortion (RD) curves
<a href=#references title="Calculation of Average PSNR Differences between RD curves">[VCEG-M33]</a>.</p><p>The basic steps are:</p><ol><li>fit a curve through several data points (see <a href=#rate-distortion-curve>Rate-Distortion Curve</a>);</li><li>find an expression for the integral of the curve <a href=#references title="Calculation of Average PSNR Differences between RD curves">[VCEG-M33]</a>;</li><li>the average difference is the difference between the integrals divided by the integration interval.</li></ol><p>In other words, to compare two encoders (or two encoding configurations) the
area between the two RD-curves must be divided by interpolation interval as shown below.</p><figure><img src=/blog/posts/bd-rate/rd-plot-delta-rate.png alt="RD Curves Delta Rate"><figcaption><p>RD Curves Delta Rate</p></figcaption></figure><p>BD-Rate is measured in percent and expresses the average percentage difference in bitrate of the two datasets
at a similar distortion value measured by an objective metric (usually PSNR).
The BD Rate value is zero when calculated metrics are the same.
In a comparison between Encoder A and Encoder B a negative BD Rate would mean Encoder A provides better
compression efficiency (lower bitrate at a similar visual quality level).
A positive value would indicate inferior compression efficiency.</p><p>If PSNR distortion value is compared using the bitrate as the basis of integration,
the metric is called BD-PSNR and is measured in dB.</p><p>It was observed that the difference between the curves is dominated by the high bitrates.
The higher the bitrate is, the wider the distance usually is between the curves.
Hence it is considered more appropriate to do the integration based on logarithmic scale of bitrate
<a href=#references title="Calculation of Average PSNR Differences between RD curves">[VCEG-M33]</a>.<br>Another approach is to split the curve into three different quality ranges: low, medium and high,
and additionally calculate the metric for low and high quality ranges
[<a href=#references title="Improvements of the BD-PSNR model.">VCEG-AI11]</a>.</p><p>The piecewise cubic interpolation combined with logarithmic scale was later found to provide
more stable results compared to a regular cubic interpolation
<a href=#references title="Reliability metric for BD measurements">[VCEG-AL22]</a>.</p><p>The impact of the number of existing curve fitting approaches is studied in
<a href=#references title="Revisiting Bjontegaard delta bitrate computation">[MHV-22]</a>.
The study also shows that the use of BD Rate metric computation
for metrics other than PSNR should be done with caution, as they might
produce unreliable results.</p><p>The BD Rate metric is widely adopted by the ITU-T JCT-VC group
<a href=#references title="Working practices using objective metrics...">[STP-VID-WPOM]</a>.</p><h2 id=useful-links>Useful Links</h2><ul><li>BD Rate estimation in Python. <a href=https://github.com/Anserw/Bjontegaard_metric>GitHub: Anserw/Bjontegaard_metric</a>.</li><li>BD Rate estimation in C++17. <a href=https://github.com/tbr/bjontegaard_cpp>GitHub: tbr/bjontegaard_cpp</a>.</li><li>BD Rate estimation in TypeScript. <a href=https://github.com/YoungSx/bjontegaard.js>GitHub: YoungSx/bjontegaard.js</a>.</li><li>BD Rate estimation in VBA (e.g. Excel). <a href=https://github.com/tbr/bjontegaard_etro>GitHub: tbr/bjontegaard_etro</a>.</li><li><strong>Subjective</strong> Comparison of ENcoders based on fItted Curves (SCENIC). <a href=https://github.com/phanhart/SCENIC>GitHub: phanhart/SCENIC</a>.</li><li><a href=https://vicuesoft.com/blog/titles/bd_rate_one_name_two_metrics/>BD-rate: one name - two metrics. AOM vs. the World.</a> ViCue Soft blog.</li></ul><h2 id=references>References</h2><p><strong>[VCEG-M33]</strong> Gisle Bjontegaard, &ldquo;<a href=https://www.itu.int/wftp3/av-arch/video-site/0104_Aus/VCEG-M33.doc>Calculation of Average PSNR Differences between RD curves</a>&rdquo;, ITU-T SG16/Q6 VCEG 13th meeting, Austin, Texas, USA, April 2001, Doc. VCEG-M33.</p><p><strong>[VCEG-AI11]</strong> Gisle Bjontegaard, &ldquo;<a href=http://wftp3.itu.int/av-arch/video-site/0807_Ber/>Improvements of the BD-PSNR model</a>&rdquo;, ITU-T SG16/Q6 VCEG 35th meeting, Berlin, Germany, 16–18 July, 2008, Doc. VCEG-AI11.</p><p><strong>[VCEG-AL22]</strong> Kenneth Andersson, Rickard Sjöberg, and Andrey Norkin. 2009. Reliability metric
for BD measurements. ITU-T SG16 Q.6 Document, VCEG-AL22.</p><p><strong>[MHV-22]</strong> Nabajeet Barman, Maria G Martini, and Yuriy Reznik. 2022. Revisiting Bjontegaard delta bitrate (BD-BR) computation
for codec compression efficiency comparison. In Proceedings of the 1st Mile-High Video Conference (MHV &lsquo;22).
Association for Computing Machinery, New York, NY, USA, 113–114. <a href=https://doi.org/10.1145/3510450.3517289>https://doi.org/10.1145/3510450.3517289</a>.</p><p><strong>[HSTP-VID-WPOM]</strong> ITU-T Technical Paper. 2020. HSTP-VID-WPOM - Working practices using
objective metrics for evaluation of video coding efficiency experiments.</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 000-6 3 3 0 000 6"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/blog/tags/video-compression/ rel=tag>Video Compression</a></li><li class=tags__item><a class="tags__link btn" href=/blog/tags/psnr/ rel=tag>PSNR</a></li><li class=tags__item><a class="tags__link btn" href=/blog/tags/quality-metrics/ rel=tag>Quality Metrics</a></li></ul></div></footer></article></main><section class=comments><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//https-maxsharabayko-github-io-blog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div><aside class=sidebar><div class="widget-search widget"><form class=widget-search__form role=search method=get action=https://google.com/search><input class=widget-search__field type=search placeholder=Search… name=q aria-label=Search…>
<input class=widget-search__submit type=submit value=Search>
<input type=hidden name=sitesearch value=https://maxsharabayko.github.io/blog/></form></div><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/blog/posts/plot-vc-frame-size/>Video Frame Sizes Visualization</a></li><li class=widget__item><a class=widget__link href=/blog/posts/bd-rate/>Bjontegaard Delta-Rate Metric</a></li><li class=widget__item><a class=widget__link href=/blog/posts/srt-4g-streaming-2022/>Examining SRT Streaming over 4G Networks</a></li><li class=widget__item><a class=widget__link href=/blog/posts/nextgen-codecs-2013/>Next Generation Video Codecs: HEVC, VP9, Daala (2013)</a></li></ul></div></div><div class="widget-taglist widget"><h4 class=widget__title>Tags</h4><div class=widget__content><a class="widget-taglist__link widget__link btn" href=/blog/tags/ffprobe/ title=Ffprobe>Ffprobe</a>
<a class="widget-taglist__link widget__link btn" href=/blog/tags/psnr/ title=PSNR>PSNR</a>
<a class="widget-taglist__link widget__link btn" href=/blog/tags/python/ title=Python>Python</a>
<a class="widget-taglist__link widget__link btn" href=/blog/tags/quality-metrics/ title="Quality Metrics">Quality Metrics</a>
<a class="widget-taglist__link widget__link btn" href=/blog/tags/srt/ title=SRT>SRT</a>
<a class="widget-taglist__link widget__link btn" href=/blog/tags/video-compression/ title="Video Compression">Video Compression</a></div></div><div class="widget-social widget"><h4 class="widget-social__title widget__title">Social</h4><div class="widget-social__content widget__content"><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=LinkedIn rel="noopener noreferrer" href=https://linkedin.com/in/maxim-sharabayko target=_blank><svg class="widget-social__link-icon icon icon-linkedin" width="24" height="24" viewBox="0 0 352 352"><path d="M0 40v272c0 21.9 18.1 40 40 40h272c21.9.0 40-18.1 40-40V40c0-21.9-18.1-40-40-40H40C18.1.0.0 18.1.0 40zm312-8c4.6.0 8 3.4 8 8v272c0 4.6-3.4 8-8 8H40c-4.6.0-8-3.4-8-8V40c0-4.6 3.4-8 8-8H312zM59.5 87c0 15.2 12.3 27.5 27.5 27.5s27.5-12.3 27.5-27.5S102.2 59.5 87 59.5 59.5 71.8 59.5 87zM187 157h-1v-21h-45v152h47v-75c0-19.8 3.9-39 28.5-39 24.2.0 24.5 22.4 24.5 40v74h47v-83.5c0-40.9-8.7-72-56.5-72-23 0-38.2 12.6-44.5 24.5zM64 288h47.5V136H64V288z"/></svg>
<span>LinkedIn</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=GitHub rel="noopener noreferrer" href=https://github.com/maxsharabayko target=_blank><svg class="widget-social__link-icon icon icon-github" width="24" height="24" viewBox="0 0 384 374"><path d="m192 0C85.9.0.0 85.8.0 191.7c0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2.0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8.0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7.0.0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4.0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5.0 25.6-.2 46.3-.2 52.6.0 5.1 3.5 11.1 13.2 9.2C329 348.2 384 276.4 384 191.7 384 85.8 298 0 192 0z"/></svg>
<span>GitHub</span></a></div></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2024 Maxim Sharabayko.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/blog/js/menu.js></script></body></html>